
var Preferences={_prefServices:null,_contextMenuEnabled:true,_preferredTargetMap:{},_prefSaved:new Array(),_socialServicesEnabled:false,_userFBAuthPreferences:true,_userTwitterAuthPreferences:true,load:function(){this._loadContextMenuSettings();this._loadSocialServicesSettings();this._getServicesList();},loadPreferredTargets:function(){this._preferredTargetMap={};if(localStorage[Constants.SERVICES_STORAGE_NAME]!=undefined){this._prefSaved=localStorage[Constants.SERVICES_STORAGE_NAME].split(',');}
this._createServicesToShowList();this._createTargetMap();},_getServicesList:function(){if((typeof localStorage["addthis_sshp"]=="undefined"||localStorage["addthis_sshp"]=="")&&(typeof localStorage["addthis_sshp_reset"]=="undefined"||localStorage["addthis_sshp_reset"]=="")){localStorage["addthis_sshp"]="facebook,twitter,email,print,gmail,stumbleupon,favorites,blogger,tumblr,pinterest,google";}
BootLoader.loadServices();},_createServicesToShowList:function(){if(this._prefServices){for(var i=0;i<this._prefServices.length;i++){if(this._prefSaved&&this._prefSaved.length==11)
break;if(typeof(this._prefServices[i])!=undefined&&this._prefServices[i]){if(this._prefSaved.indexOf(this._prefServices[i])<0)
this._prefSaved.push(this._prefServices[i]);}}}},_createTargetMap:function(){var prefServiceCode;var target;var i=0;if(this._prefSaved&&typeof(this._prefSaved)!=undefined&&this._prefSaved.length){for(i=0;i<this._prefSaved.length;i++){if(typeof(this._prefSaved[i])!=undefined&&this._prefSaved[i]){prefServiceCode=this._prefSaved[i]+"_name";target=new Services.serviceMap(this._prefSaved[i],(typeof window.atServiceTitle[prefServiceCode]!="undefined"?window.atServiceTitle[prefServiceCode]:this._prefSaved[i]));this._preferredTargetMap[target.name]=target;}}}
if(i<11){var at_filler_services="facebook,twitter,email,print,gmail,stumbleupon,favorites,blogger,tumblr,pinterest,google";var at_filler_array=at_filler_services.split(",");for(var j=0;j<11;j++){if(i>=11)break;if(this._prefSaved.indexOf(at_filler_array[j])<0){prefServiceCode=at_filler_array[j]+"_name";target=new Services.serviceMap(at_filler_array[j],(typeof window.atServiceTitle[prefServiceCode]!="undefined"?window.atServiceTitle[prefServiceCode]:at_filler_array[j]));this._preferredTargetMap[target.name]=target;i++;}}}},getPreferredServicesDetails:function(){return this._preferredTargetMap;},setPreferredServices:function(servicesList){localStorage[Constants.SERVICES_STORAGE_NAME]=servicesList;this.loadPreferredTargets();},_loadContextMenuSettings:function(){_contextMenuEnabled=(typeof localStorage["context_menu"]=="undefined"||!localStorage["context_menu"]||localStorage["context_menu"]=="true")?true:false;},isContextMenu:function(){return _contextMenuEnabled;},setContextMenu:function(contextVal){_contextMenuEnabled=contextVal;ContextMenu.removeContextMenu();if(!contextVal)
ContextMenu.removeContextMenu();else{ATX.contextMenu.initialize();ContextMenu.init();}},_loadSocialServicesSettings:function(){Preferences._userFBAuthPreferences=(localStorage["fb_auth_pref"]=="true")?true:false;Preferences._userTwitterAuthPreferences=(localStorage["twitter_auth_pref"]=="true")?true:false;Preferences._socialServicesEnabled=(localStorage["social_services"]=="true")&&(Preferences._userFBAuthPreferences||Preferences._userTwitterAuthPreferences)?true:false;},setSocialServices:function(socialVal){Preferences._socialServicesEnabled=socialVal;},isSocialServices:function(){return Preferences._socialServicesEnabled;},setFBAuthPreference:function(fbAuthVal){localStorage["fb_auth_pref"]=fbAuthVal;Preferences._userFBAuthPreferences=fbAuthVal;},isFBAuthPreference:function(){return Preferences._userFBAuthPreferences;},setTwitterAuthPreference:function(twitterAuthVal){localStorage["twitter_auth_pref"]=twitterAuthVal;Preferences._userTwitterAuthPreferences=twitterAuthVal;},isTwitterAuthPreference:function(){return Preferences._userTwitterAuthPreferences;}};var fetchServices=function(response){var servicesData=response.data;window.atServiceTitle=new Array();for(var i in servicesData){var service=servicesData[i];if(typeof service=="object"&&typeof service.code!="undefined"){var at_service_title=service.code+"_name";window.atServiceTitle[at_service_title]=service.name;}}};var ATX=ATX||{};ATX.preferences={initialize:function(){if(typeof localStorage['new_install']==='undefined'){this.firstRun();}},firstRun:function(){localStorage['new_install']="false";localStorage["context_menu"]="true";localStorage["context_menu_search"]="false";}};